#!/bin/bash

# Download the bigwig files using the reviewer token
# untar the file
# Rename the files to remove the accession number in the file name

cd $1

# Clean folder first
rm -rf *

wget --header 'Host: www.ncbi.nlm.nih.gov' --user-agent 'Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0' --header 'Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8' --header 'Accept-Language: fr,fr-FR;q=0.8,en-US;q=0.5,en;q=0.3' --referer 'https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi' --header 'DNT: 1' --header 'Sec-GPC: 1' --header 'Cookie: ncbi_sid=9ED3DF3A7A023053_34722SID; ncbi-login-route=google; MyNcbiSigninPreferences=O2dvb2dsZSZvcmNpZCY%3D; gdh-data-hub-csrftoken=3LnsJBs83FstHqmwsssHgejXTPU8uVu3; ncbi_prevPHID=CE8EEF447D159B3100000000000C000C; PRESERVTARGET=%2FtYTXpgzJne16bwfb4ZN2lGInyYoZNk58TVbSvhIR0njSJplCp65%2BiF2SZAktvmmznDxgJBJhBCH%0ANoo2je1cMk0RXykLSXa4UwW7u0%2B%2Fc1X7WzHdCi209NjSVDPLNfOmFzmtz50Uuh6EfD95OQ%2BYQ2B%2B%0Aq7BP3es9s8ArLlZd9XW7NS72Ulu8cigULF%2FZADnu%2FPZf8DmPLOXuV6xWf0fqcNlZXwWhiCjrPJiU%0AU594rDm20QBWFe5y0VjWXnJtzYm7uSPkWDQYJ8htbKyWwjn4aG0xcYfTBSBUTOi9A%2Bo1BnUPHLIi%0A8V9%2Fi7S2i2vLCCwVTCSGS0pctKKWZRmzEmP9NB4rA167%2FSMuyX6ezHZNUyztiKaga84g5monl5bT%0AjNlmWeBFQV90piriK2wjmey3mIoTu2eJyDi%2Bx%2FO7pwMTfeiU2WXZ5h3U4kRBxw%2FR6%2FrCMYtVrzXp%0A%2FexiuMJDHQmiDPowP8dxw97tgs353jnBRGe8jpoCPoPG2hywQnwXtxW8SjWp19yTypxVFl4KnD1e%0A5aoPyq%2F7tPDRPbW7UikYuihFvX0mD1TH7A0G9Bk%2B36y%2F7jL8oW7OArzEbESjcx2aVRL%2B3VqzX1Oc%0AZcFWXfVarYgckE8EeyNwFwhPDoASs2T4SVNAJAQ38A0bYzCAxc6mQLqADqesOuuveClDDgB8WITg%0A1QnE32rGsLz37nzAQ89V; NIHSMSESSION=+cLKTOT7VHvlDKfhgYbNyJSO8f0fmoxLWbjwR0GjvPr0yHeiLtLi7MuWhrGhuYaY5LKCeBPksauELWkr2DJ6V+zi8MLPJSb0x7cdRfPqMqpja1lboEVcqrb8jRK5Wdbr045ALMNnlQmg5Wp+c+8dNGSHEInhloButQkLmUxmxpVKWwmNr/IgQ664h1j2cBwh9yjCw3uFQwvqlSOU2wZ+31NztPEPs6+mdYhb3dsXpzTLj4ZR3zb5aenF4hMqsg/k5lUouSLTonz4UxQMxXmkosQ1pD9XePZBJWhRfaTjSfj4I166l1atLvGHTvs2r0WXSd/WiBplUs8jfdqCxt6qCGEVsjwMffrMcI5/Zttb2o3l2QMjF9wbaP6kaLn9pDdQwIuuFH1PZrDG8imKthcooAr44BpJCnjnKgV0TxE9nHjdbEe1QvxkZUHPqB+pA79j6xW6GcG/HO94xQWgfqHA7gihkXZx/DkjEN9f8KNzYj1GbHlfYLE2D9SMVrdQMVLcnJU8dwU2d+mzPUowKtx7D65IK3DDq41TS1RTojFCEOcN90TDLpBuNsqO3HzbUPtlnCP9FoFXVW7SJvbgpkJatZlhIge76u1ZwhmexQ/4h10SVUONzXDtNYbjR/T+nJlf7Bkz0Uu06Q/WR7QpsbqXBwcvoVUpMFZS5ofCR+ImDeFtrAf1I8o0RI5OxdhpoP5Vi6PA8QpDlvo+0/27G3KDcY3mGMfYa8x5p/+depflr0HXJrywJET1EqRD1Hqz0DYocLIwc4gW9y5zuGLhOfDr36cg9E6lNyWvk5UV6Y/AoijetDc6TCuh2rVpIIqZ8IpbiFUSiDvVcSMuHLc4BdnTgF/9mVGKHinkPqh5nxvR8e9tkuO5KniD0VDvwDY04VBFYRmhCG6EClJQbuoZ6b3q+PyDh61YXKYmxurpUvccZTVhEdWAB5RzClyoJ7nI2Rk55EgSGFnRCe8Mh2u2WYwaKno+fSfmlR+W029fTrsBDfMgkiNNzcQnPv3heVJB6wc82jar8jp9JUt+iNLma0WiaO4JEUfnp+EROjLKIEWTkap90+W+sJJDVWvXFn5b/HDlL4xUK+kKMAe/a6Mk04hruewF9gFL9g55MMYrkO+ZIgZPLUNILEt3AXpq1fqLsFvc+OE+QiQp0oIq/5g3bC+DI29s8PC42YLWGqxxhKXhWxRSGPgrYoIorZPvkRa9vc07oK10KRjKw1NeGwFdrMDzVlMgW7AABKXK0xKtRUOeuQuYU6Sy9NHEYYw8Z8o2J1PIWUjxYEvoOqShIGrlsSqVmccobOmeD3BJxcZrZO/oKZ6JQjdFRGpuiYNDEx+dzUqu2leqPTq/SDvgPMebFzMMEDqzrjYvTK24vNElvVEO0Y6vxmTHXktL4M/0RQze5sU+Whqu86wu9TrLxnJRuMz8oZoHSV7kx0zv; NIHSMPROFILE=9i9xFyZxcZ3DeEBWJ1M%2B19JwtceqNgFL6uS5Tq34aL%2BHjuuB2L5oUmjZ5tE4aqluV1jg0I0FpGRZXIVxXleEB6yaCUybIZWk9dydfutosxjblEH8vG8H5SeZS4ZtSdY0mWdge8dW8bVSpB5v4AkQCdNIat%2FTAdPo14oXbWfe%2BXI8g44Vca3UODnWOvP6I1d8r2%2FJyuf0jbqIyvd2DSzoTkgheHSF1ce4tWslZ3qfMXZxPQ%2BExg%2FAG%2FjR6oMdvUtk6D4xFjVLjaeiTRclmqXbhfPYG2NQW4Bzu23vyTUju%2FYSkkTlxmhNkNOQuKdF%2BUZZdKqQV%2FN64Cfl5o6seB1ZRr19KbnMWr4CSQ%2FDroCT8F%2BzzB%2F2oHYG08OXKUAf51dHPyAubO%2FUxZY35vtqw3nZ3QObsyi1jUyempPaDiE4XOptpCFNgL6zBoUVFOG4BsKJ%2FBHz9o7CnzMaPFaLRzJXU8%2BidrPtabI%2FsCL4e9AxNZPD5If0SLlw%2FwfzhBy2jgogWetkUXmTpaO3wA5hL6njk0OlIIXchKrGUL6Fj9hUenk%3D; WebCubbyUser=FCDM9IUIC9P211O5RXRJQFPXA9RZ3VQ5%3Blogged-in%3Dtrue%3Bmy-name%3Disabelle.stevant%2540gmail.com%3Bpersistent%3Dtrue%409ED3DF3A7A023053_34722SID; WebEnv=1rCBw1bUGkh_7U3yJClxCL8pulNpxM0ZD5IGe9jvetrAl%409ED3DF3A7A023053_34722SID; gmctoken=16Ml6eJKgVbCBLs6MQYsKUh; ncbi_pinger=N4IgDgTgpgbg+mAFgSwCYgFwgAwGEAsATAGKECCZA7AKIBCZ1hAbAIzbsedcsgA0IAYwA2yAQGsAdlAAeAF0ygAzAE5MIQpWz4ArHxD5sajU209++fGuGjJM+ed1Yz+pmoBmAQyEBnKHvyUamzauuYAHEbYior+qlh62oZYiLKyYN4YAPSZAO55AHQSAgBGyIVCALaFyIj5AOYA9jCZdVANmagNORJCDR6omQD8HgICALwA4gDKjJSUTPhMAGRuDRAVHrJjbshCfvymagmEagAUKWkAlHqaagAyyBJiAAS4IuI3PFjnqWDX/JQTlgWm0Ol0en0BsNRpMZhp5osVmsNlsdnsQABffgAVwh/SkcgUIGi7i8vj0iksWFkEGx+2JEXi/BURk0iX8SXU8xC/ipIFxvXxdn8jnUCVcTmUrgOgSwhn4rDUihYrixggaFQqDQkBPkGFAQJArQaFKO5nc2KEQgSZvUnLwRFIFBo9EYrC4Hs4zkIXyNbQwADkAPIB6gYNyWoSBkPUPSEQ15HKFEplHpVCQ1epNONxEAsZSEeXEzlsMJF5VBAvlw2lov4GJy/L4Fj5IvaBt5qsJPnKfOYjFAA==' --header 'Upgrade-Insecure-Requests: 1' --header 'Sec-Fetch-Dest: document' --header 'Sec-Fetch-Mode: navigate' --header 'Sec-Fetch-Site: same-origin' --header 'Sec-Fetch-User: ?1' 'https://www.ncbi.nlm.nih.gov/geo/download/?acc=GSE277646&format=file' --output-document 'GSE277646_RAW.tar'

tar -xf GSE277646_RAW.tar

for file in *.bw; do 
	mv $file ${file#*_}; 
done && echo "Download done!" && rm GSE277646_RAW.tar